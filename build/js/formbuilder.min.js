function insertOption(e){var t=document.getElementById("drop"+e),i=document.createElement("option");i.text=prompt("Name your option"),"null"!==i.text&&i.text&&t.add(i)}function removeOption(e){var t=document.getElementById("drop"+e);t.remove(t.selectedIndex)}$(document).ready(function(){function e(){var e=0;$("#yourform").remove();var t=$('<fieldset id="yourform"><legend>Your Form</legend></fieldset>');$("#buildyourform div").each(function(){var i,n="input"+$(this).attr("id").replace("field",""),o=$('<label for="'+n+'">'+$(this).find("input.fieldname").first().val()+"</label>");switch($(this).find("select.fieldtype").first().val()){case"textbox":i=$('<div class="previewForm"><input type="text" id="'+n+'" name="'+n+'" /></div>');break;case"dropdown":e++,i=$('<div class="previewForm"><select id="drop'+e+'">  </select> <button type="button" onclick="insertOption('+e+')">Insert option</button> <button type="button" onclick="removeOption('+e+')">Remove option</button></div>')}t.append(o),t.append(i)}),$("body").append(t)}$("#add").click(function(){var t=$("#buildyourform div").length+1,i=$('<div class="fieldwrapper" id="field'+t+'"/>'),n=$('<input type="text" class="fieldname" />'),o=$('<select class="fieldtype"><option value="textbox">Text</option><option value="dropdown">Drop</option> </select>'),d=$('<input type="button" class="remove" value=Remove>');d.click(function(){$(this).parent().remove()}),i.append(n),i.append(o),i.append(d),$("#buildyourform").append(i),o.change(function(){e()}),n.on("input",function(){e()}),e()}),$("#submit").click(function(){var e={business:"temp",fields:[]},t=0,i=$("fieldset");i.children().each(function(){if($(this).find("select.fieldtype").first().val())if("dropdown"===$(this).find("select.fieldtype").first().val()){var i=$(this).find("input.fieldname").first().val(),n={type:"dropdown",label:i,options:[]};t++;var o=$("#drop"+t+" option");$.map(o,function(e){n.options.push(e.value)}),e.fields.push(n)}else e.fields.push({type:"textfield",label:$(this).find("input.fieldname").first().val()})}),$.ajax({url:"/api/m/form",type:"POST",data:JSON.stringify(e),contentType:"application/json",dataType:"json",success:function(){}})})});